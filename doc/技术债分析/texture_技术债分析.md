# 技术债分析报告: texture.py

## 1. 文件概览
- **文件路径**: `texture.py`
- **主要功能**: 处理材质赋予、UV 展开、纹理映射。
- **代码规模**: 约 1300+ 行。

## 2. 主要技术债

### 2.1 手动 UV 操作 (Manual UV Manipulation)
- **问题描述**: 代码中包含大量直接操作 UV 坐标的数学计算（缩放、旋转、平移）。
- **影响**: 极其脆弱。依赖于 Mesh 的拓扑结构，一旦模型拓扑改变（如增加了细分），UV 计算可能完全错误。

### 2.2 硬编码的材质索引 (Hardcoded Material Slots)
- **问题描述**: 这里的代码假设了材质槽（Material Slot）的顺序（如 slot 0 是红漆，slot 1 是彩画）。
- **影响**: 极其危险。如果用户手动修改了材质列表，或者资产库的材质顺序发生变化，整个着色逻辑将失效。

### 2.3 复杂的几何切分 (Bisect Abuse)
- **问题描述**: 为了给柱头、枋头贴图，代码使用了 `bisect`（切分）操作将模型物理切开，赋予不同材质后再合并。
- **影响**: 破坏了模型的拓扑结构，增加了面数，且导致后续无法调整倒角等修改器。

### 2.4 缺乏 PBR 流程支持
- **问题描述**: 目前的逻辑主要针对传统的漫反射贴图。缺乏对 PBR（粗糙度、法线、金属度）贴图的统一管理。

## 3. 改进建议
1.  **使用材质节点**: 尽量在 Shader Node 中通过 Object Info 或 Attribute 节点控制贴图映射，而不是物理修改 UV。
2.  **材质名称索引**: 通过材质名称而不是 Slot 索引来查找材质。
3.  **多材质混合**: 使用 Vertex Color 或 Mask 贴图来混合不同的材质层，而不是物理切分模型。
