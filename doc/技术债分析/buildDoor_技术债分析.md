# buildDoor.py 技术债分析

## 1. 文件概览
- **功能**: 负责隔扇、槛窗、板门等具体装修构件的营造。
- **代码行数**: 约 1860 行。
- **依赖**: `const`, `data`, `utils`, `texture`。

## 2. 主要技术债

### 2.1 代码重复度极高
- **问题**: `__buildGeshan`（隔扇）、`__addBarwindow`（直棂窗）、`__addFlipwindow`（支摘窗）等函数中存在大量重复的构建代码（如创建边框、仔边、倒角、材质设置）。
- **影响**: 代码膨胀，修改通用样式（如倒角大小）需要修改多处。
- **建议**: 提取通用的“装修构建基类”或工具函数（如 `buildFrame`, `buildPanel`），复用通用部件的生成逻辑。

### 2.2 复杂的参数传递
- **问题**: 函数参数列表过长，且通过 `ACA_data` 隐式传递参数。
- **影响**: 函数签名不清晰，难以知道函数真正需要哪些数据。
- **建议**: 使用参数对象（Parameter Object）或上下文对象（Context Object）传递构建配置。

### 2.3 逻辑深层嵌套
- **问题**: 在 `__getGeshanData` 等函数中，存在多层嵌套的 `if` 语句来处理不同抹头数量（二抹到六抹）的布局。
- **影响**: 代码可读性极差，逻辑难以验证。
- **建议**: 将不同抹头数量的布局逻辑拆分为独立的策略类或配置表（Configuration Table）。

### 2.4 硬编码的几何构造
- **问题**: 大量的几何构造代码（如 `addCube`, `drawHexagon`）直接散落在业务逻辑中，缺乏语义化。
- **影响**: 难以理解代码意图（是在画框？还是画心？）。
- **建议**: 封装语义化的构建函数（如 `createFrameBar`, `createWindowPane`）。

### 2.5 缺乏组件化设计
- **问题**: 所有的装修部件都是通过过程式代码生成的，缺乏面向对象的组件化设计（如 `Geshan` 类, `Window` 类）。
- **影响**: 难以扩展新的装修风格或类型。
- **建议**: 引入面向对象的组件体系。

## 3. 重构优先级
- **高**: 消除不同窗型构建函数间的重复代码，提取通用逻辑。
- **中**: 简化 `__getGeshanData` 的复杂逻辑，使用配置表驱动。
- **低**: 引入面向对象设计（长期目标）。
