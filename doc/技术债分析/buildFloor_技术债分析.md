# buildFloor.py 技术债分析

## 1. 文件概览
- **功能**: 负责柱网（Floor）和柱子（Pillar）的生成与布局计算。
- **代码行数**: 约 1860 行。
- **依赖**: `utils`, `const`, `data`。

## 2. 主要技术债

### 2.1 复杂的坐标计算逻辑
- **问题**: 柱网生成涉及大量的坐标变换和几何计算（如 `net_x`, `net_y` 的生成）。这些逻辑直接散落在构建函数中。
- **影响**: 逻辑复用性差，难以单独测试坐标计算的正确性。
- **建议**: 将柱网坐标计算逻辑封装为独立的类（如 `GridSystem`），负责管理网格数据和坐标转换。

### 2.2 数据耦合
- **问题**: 函数高度依赖 `ACA_data` 对象，直接读取和修改其属性。
- **影响**: 导致模块与数据结构紧密耦合，数据结构变更将引发连锁反应。
- **建议**: 定义明确的输入参数接口（DTO），而不是直接传递整个数据对象。

### 2.3 冗余的柱子生成逻辑
- **问题**: 针对不同类型的柱子（金柱、檐柱、角柱等），存在重复的生成代码。
- **影响**: 代码重复率高，修改柱子样式时需要修改多处。
- **建议**: 使用工厂模式（Factory Pattern）统一柱子的创建过程。

### 2.4 缺乏几何容错
- **问题**: 在非标准柱网（如非矩形布局）下，现有的计算逻辑可能失效。
- **影响**: 限制了插件的适用范围。
- **建议**: 引入更通用的几何算法库或增强现有的网格系统以支持不规则布局。

## 3. 重构优先级
- **高**: 封装柱网计算逻辑到独立类中。
- **中**: 消除重复的柱子生成代码。
- **低**: 优化非标准布局的支持。
